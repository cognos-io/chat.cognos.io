<div class="wrapper" [class.is-mobile]="isMobile()">
  <mat-toolbar color="primary" class="toolbar" role="heading">
    <button mat-icon-button (click)="sideNav.toggle()">
      <mat-icon color="secondary" fontSet="bi" fontIcon="bi-list"></mat-icon>
    </button>
    <div class="flex w-full items-center justify-center md:ms-4 md:justify-start">
      <app-cognos-logo class="-ms-10 h-6 md:ms-0"></app-cognos-logo>
    </div>
  </mat-toolbar>
  <mat-sidenav-container
    class="page sidebar-container"
    [style.paddingTop.px]="isMobile() ? 56 : 0"
  >
    <mat-sidenav
      #sideNav
      [mode]="isMobile() ? 'over' : 'side'"
      [fixedInViewport]="isMobile()"
      [opened]="!isMobile()"
      fixedTopGap="56"
      role="navigation"
    >
      <div class="sidebar h-full">
        <button mat-button color="primary" (click)="router.navigateByUrl('')">
          <mat-icon fontSet="bi" fontIcon="bi-plus-circle-fill"></mat-icon>
          <ng-container i18n="button|action to create a new conversation">
            New conversation
          </ng-container>
        </button>
        <mat-nav-list class="flex-grow overflow-y-auto">
          @for (
            conversation of conversationService.conversationList();
            track conversation.record.id
          ) {
            <a
              mat-list-item
              [routerLink]="['c', conversation.record.id]"
              class="conversation-list-item group"
              [matTooltip]="conversation.decryptedData.title"
              matTooltipPosition="after"
            >
              <p matListItemTitle>{{ conversation.decryptedData.title }}</p>
              <div
                matListItemMeta
                class="conversation-list-item-actions hidden group-hover:flex group-active:flex"
              >
                <button
                  mat-icon-button
                  class="actions-button"
                  [matMenuTriggerFor]="menu"
                  aria-label="Open conversation menu"
                >
                  <mat-icon fontSet="bi" fontIcon="bi-three-dots-vertical"></mat-icon>
                </button>
              </div>
            </a>
            <mat-menu #menu="matMenu">
              <button
                mat-menu-item=""
                (click)="onPinConversation(conversation.record.id)"
              >
                <mat-icon fontSet="bi" fontIcon="bi-pin-angle"></mat-icon>
                Pin
              </button>
              <button
                mat-menu-item=""
                (click)="onRenameConversation(conversation.record.id)"
              >
                <mat-icon fontSet="bi" fontIcon="bi-pencil-square"></mat-icon>
                Rename
              </button>
              <button
                mat-menu-item=""
                (click)="onDeleteConversation(conversation.record.id)"
              >
                <mat-icon fontSet="bi" fontIcon="bi-trash3"></mat-icon>
                Delete
              </button>
            </mat-menu>
          }
        </mat-nav-list>
        <div class="flex justify-end gap-2">
          <button
            mat-icon-button
            (click)="onOpenHelpDialog()"
            matTooltip="Get help or contact me"
          >
            <mat-icon fontSet="bi" fontIcon="bi-question-circle"></mat-icon>
          </button>

          <button
            mat-icon-button
            (click)="router.navigate(['', 'auth', 'logout'])"
            matTooltip="Logout"
          >
            <mat-icon fontSet="bi" fontIcon="bi-box-arrow-right"></mat-icon>
          </button>
        </div>
      </div>
    </mat-sidenav>
    <mat-sidenav-content role="main">
      <router-outlet></router-outlet>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
